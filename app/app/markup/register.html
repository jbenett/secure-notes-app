<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../styles/register.css" media="screen" />
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <title>Register</title>
  </head>
  <body>
    <h1>Register</h1>
    <form id="register-form">
      <div class="container">
        <label>
          <h4>Email</h4>
          <input id="email" name="email" class="field" type="text" maxlength="45">
        </label>
        <label>
          <h4>Username</h4>
          <input id="username" class="field" type="text" maxlength="45">
        </label>
        <label>
          <h4>Password</h4>
          <input id="password" name="password" class="field" type="password" maxlength="45">
        </label>
        <div id='submit_container'>
          <button id='submit-btn'>Submit</button>
        </div>
        <div id='response-div'>
          <p id="response"></p>
        </div>
        <a href="index.html">
          <button type="button" id ="back-button">Back to Login</button>
        </a>
      </form>
    </div>
    <script type="text/javascript" src="../register.js"></script>
    <script>
      // You can also require other files to run in this process
      require('../renderer.js');
    </script>
    <script>
      var $ = jQuery = require('jquery'); // as node_modules
    </script>
    <script>
      function testPassword(p) {
          // return true if the password contains:
          // at least one digit
          // at least one special character
          // at least one alphabetic
          // and no blank space
          return /^(?=.*\d)(?=(.*\W))(?=.*[a-zA-Z])(?!.*\s)/.test(p);
      }

      $("#submit-btn").click(function(e) {
          e.preventDefault();
          var email = $('#email').val();
          var password = $('#password').val();
          if (email == "" || (password == "")) {
            $('#response-div').addClass("failure");
            $('#response').html("Please fill out necessary fields");
          }
          else if (!testPassword(password)) {
            $('#response-div').addClass("failure");
            $('#response').html("Please meet all password requirements");
          }
          else {
            $.post("http://localhost:3000/register", {email: email, password: password})
            .done(function(data) {
                $('#response-div').removeClass();
                $('#response-div').addClass("success");
                $('#response').html("Account Created Successfully");
            })
            .fail(function() {
                $('#response-div').removeClass();
                $('#response-div').addClass("failure");
                $('#response').html("Account Already Exists");
            });
          }
      });
    </script>
    <script>window.$ = window.jQuery = require('jquery');</script>
    <script src="../login.js"></script>
  </body>
</html>
