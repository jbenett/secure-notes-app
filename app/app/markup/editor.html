<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../styles/editor.css" media="screen" />
    <meta charset="UTF-8">
    <title>Edit Note</title>
  </head>
  <body>
    <div class="nav">
      <span class="back-btn-wrapper">
        <a href="notes.html">
          <button id="back-btn">&#8592;</button>
        </a>
      </span>
      <span id="save-btn-wrapper">
        <button id="save-btn">&#10003;</button>
      </span>
      <span>
        <img src="../images/pencil.png"></img>
        <!-- source of image: https://commons.wikimedia.org/wiki/File:Simpleicons_Business_pencil-on-a-notes-paper.svg -->
      </span>
      <span id="logout-btn-wrapper">
          <a href="index.html">
            <button id="logout-btn">Logout</button>
          </a>
      </span>
    </div>
    <div class="textarea-wrapper">
      <textarea placeholder="Enter New Note" id="note-content"></textarea>
    </div>
  </body>
  <script>window.$ = window.jQuery = require('jquery');</script>
  <script>
    let email = localStorage.getItem("email");
    let password = localStorage.getItem("password");
    let temp_auth_token = localStorage.getItem("temp_auth_token");

    $('#save-btn').click(function(e) {
        e.preventDefault();
        let content = $('#note-content').val();

        // Publish note to DB
        console.log(email, temp_auth_token, content);
        $.post("http://localhost:3000/notes/new", {email: email, temp_auth_token: temp_auth_token, content: content, password: password})
        .done(function(result) {
            // Redirect user to view notes
            window.location.href="notes.html";
        })
        .fail(function(result) {
            alert("Could not add a note. Please try again.");
            window.location.href="notes.html";
        });
    });
  </script>

</html>
